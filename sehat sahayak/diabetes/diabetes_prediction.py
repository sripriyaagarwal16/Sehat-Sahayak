# -*- coding: utf-8 -*-
"""Diabetes Prediction

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1TFpj4NCNjovZx_nlBIsEI2g8PzJ2JyIM

# Diabetes Prediction
"""
import os
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
from PIL import Image
diabetes=pd.read_csv('diabetes_prediction_dataset.csv')

diabetes.head()

diabetes.dtypes

diabetes['age'] = diabetes['age'].round().astype(int)
diabetes['bmi'] = diabetes['bmi'].round().astype(int)
diabetes['HbA1c_level'] = diabetes['HbA1c_level'].round().astype(int)

diabetes=diabetes.drop(columns=['smoking_history'])

from sklearn import preprocessing
le = preprocessing.LabelEncoder()
diabetes['gender']= le.fit_transform(diabetes['gender'])

X2=diabetes.drop(columns=['diabetes'])
Y2=diabetes['diabetes']

from sklearn.model_selection import train_test_split
X2_train,X2_test,Y2_train,Y2_test=train_test_split(X2,Y2, test_size=0.2) #splitting the model into 80:20 ratio

"""Random Forest Classifier"""

from sklearn.ensemble import RandomForestClassifier

rfc=RandomForestClassifier(n_estimators=100,max_depth=10)

rfc.fit(X2_train,Y2_train)

rfc.predict(X2_test)

Y2_test

rfc.score(X2_test,Y2_test)

# Create the directory if it doesn't exist
import pickle

# Define the filename
filename = 'diabetes.pkl'

# Save the model
with open(filename, 'wb') as file:
    pickle.dump(rfc, file)

print(f'Model saved to {filename}')